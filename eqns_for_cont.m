function  rdot=eqns_for_cont(t,r,Omega,Amp,L, a, d, const1, gamma1, gamma2, alpha1, alpha2, beta1, beta2, mu1, mu2)

r1 = r(:,1); r2 = r(:,3);

F1 = (const1.*(10.*(2.*L.*r1 - 2.*L.*r2 +...
    3.*a.*(r1 - r2).*cos((3.*r1)./(2.*L)) + 2.*a.*L.*sin((3.*r1)./(2.*L)) +...
    3.*a.^2.*sin((3.*(r1 - r2))./(2.*L)) - 2.*a.*L.*sin((3.*r2)./(2.*L))).*...
    (sin((3.*r1)./(2.*L)).*(-3.*a.*(cos((3.*r1)./(2.*L)) - cos((3.*r2)./(2.*L))).*...
    cos((3.*r2)./(2.*L)).*(r1 - r2 + a.*sin((3.*r1)./(2.*L)) - a.*sin((3.*r2)./(2.*L))) +...
    sin((3.*r2)./(2.*L)).*(d.^2 + a.^2.*(cos((3.*r1)./(2.*L)) - cos((3.*r2)./(2.*L))).^2 -...
    2.*(r1 - r2 + a.*sin((3.*r1)./(2.*L)) - a.*sin((3.*r2)./(2.*L))).^2)) +...
    cos((3.*r1)./(2.*L)).*(3.*a.*(cos((3.*r1)./(2.*L)) - cos((3.*r2)./(2.*L))).*...
    sin((3.*r2)./(2.*L)).*(-r1 + r2 - a.*sin((3.*r1)./(2.*L)) + a.*sin((3.*r2)./(2.*L))) +...
    cos((3.*r2)./(2.*L)).*(d.^2 - 2.*a.^2.*(cos((3.*r1)./(2.*L)) - cos((3.*r2)./(2.*L))).^2 +...
    (r1 - r2 + a.*sin((3.*r1)./(2.*L)) - a.*sin((3.*r2)./(2.*L))).^2))) + (2.*a.^2 + d.^2 + r1.^2 -...
    2.*r1.*r2 + r2.^2 - 2.*a.^2.*cos((3.*(r1 - r2))./(2.*L)) + 2.*a.*(r1 - r2).*sin((3.*r1)./(2.*L)) -...
    2.*a.*r1.*sin((3.*r2)./(2.*L)) + 2.*a.*r2.*sin((3.*r2)./(2.*L))).*(-21.*a.*(r1 - r2).*...
    cos((3.*r1)./(2.*L)) + 6.*a.*(r1 - r2).*cos((6.*r1 - 3.*r2)./(2.*L)) +...
    3.*a.*r1.*cos((3.*(r1 - 2.*r2))./(2.*L)) - 3.*a.*r2.*cos((3.*(r1 - 2.*r2))./(2.*L)) +...
    4.*L.*r1.*cos((3.*(r1 - r2))./(2.*L)) - 4.*L.*r2.*cos((3.*(r1 - r2))./(2.*L)) -...
    12.*L.*r1.*cos((3.*(r1 + r2))./(2.*L)) + 12.*L.*r2.*cos((3.*(r1 + r2))./(2.*L)) -...
    14.*a.*L.*sin((3.*r1)./(2.*L)) + 2.*a.*L.*sin((6.*r1 - 3.*r2)./(2.*L)) +...
    2.*a.*L.*sin((3.*(r1 - 2.*r2))./(2.*L)) - 24.*a.^2.*sin((3.*(r1 - r2))./(2.*L)) +...
    6.*d.^2.*sin((3.*(r1 - r2))./(2.*L)) - 3.*r1.^2.*sin((3.*(r1 - r2))./(2.*L)) +...
    6.*r1.*r2.*sin((3.*(r1 - r2))./(2.*L)) - 3.*r2.^2.*sin((3.*(r1 - r2))./(2.*L)) +...
    6.*a.^2.*sin((3.*(r1 - r2))./L) + 14.*a.*L.*sin((3.*r2)./(2.*L)) +...
    9.*r1.^2.*sin((3.*(r1 + r2))./(2.*L)) - 18.*r1.*r2.*sin((3.*(r1 + r2))./(2.*L)) +...
    9.*r2.^2.*sin((3.*(r1 + r2))./(2.*L)))))./(16.*L.*pi.*(d.^2 + a.^2.*(cos((3.*r1)./(2.*L)) -...
    cos((3.*r2)./(2.*L))).^2 + (r1 - r2 + a.*sin((3.*r1)./(2.*L)) - a.*sin((3.*r2)./(2.*L))).^2).^(7./2));

F2 = (const1.*(10.*(-2.*L.*r1 + 2.*L.*r2 -...
    3.*a.*(r1 - r2).*cos((3.*r2)./(2.*L)) - 2.*a.*L.*sin((3.*r1)./(2.*L)) -...
    3.*a.^2.*sin((3.*(r1 - r2))./(2.*L)) + 2.*a.*L.*sin((3.*r2)./(2.*L))).*...
    (sin((3.*r1)./(2.*L)).*(-3.*a.*(cos((3.*r1)./(2.*L)) - cos((3.*r2)./(2.*L))).*...
    cos((3.*r2)./(2.*L)).*(r1 - r2 + a.*sin((3.*r1)./(2.*L)) - a.*sin((3.*r2)./(2.*L))) +...
    sin((3.*r2)./(2.*L)).*(d.^2 + a.^2.*(cos((3.*r1)./(2.*L)) - cos((3.*r2)./(2.*L))).^2 -...
    2.*(r1 - r2 + a.*sin((3.*r1)./(2.*L)) - a.*sin((3.*r2)./(2.*L))).^2)) +...
    cos((3.*r1)./(2.*L)).*(3.*a.*(cos((3.*r1)./(2.*L)) - cos((3.*r2)./(2.*L))).*...
    sin((3.*r2)./(2.*L)).*(-r1 + r2 - a.*sin((3.*r1)./(2.*L)) + a.*sin((3.*r2)./(2.*L))) +...
    cos((3.*r2)./(2.*L)).*(d.^2 - 2.*a.^2.*(cos((3.*r1)./(2.*L)) - cos((3.*r2)./(2.*L))).^2 +...
    (r1 - r2 + a.*sin((3.*r1)./(2.*L)) - a.*sin((3.*r2)./(2.*L))).^2))) -...
    (2.*a.^2 + d.^2 + r1.^2 - 2.*r1.*r2 + r2.^2 - 2.*a.^2.*cos((3.*(r1 - r2))./(2.*L)) +...
    2.*a.*(r1 - r2).*sin((3.*r1)./(2.*L)) - 2.*a.*r1.*sin((3.*r2)./(2.*L)) +...
    2.*a.*r2.*sin((3.*r2)./(2.*L))).*(3.*a.*(r1 - r2).*cos((6.*r1 - 3.*r2)./(2.*L)) +...
    6.*a.*(r1 - r2).*cos((3.*(r1 - 2.*r2))./(2.*L)) + 4.*L.*r1.*cos((3.*(r1 - r2))./(2.*L)) -...
    4.*L.*r2.*cos((3.*(r1 - r2))./(2.*L)) - 21.*a.*r1.*cos((3.*r2)./(2.*L)) +...
    21.*a.*r2.*cos((3.*r2)./(2.*L)) - 12.*L.*r1.*cos((3.*(r1 + r2))./(2.*L)) +...
    12.*L.*r2.*cos((3.*(r1 + r2))./(2.*L)) - 14.*a.*L.*sin((3.*r1)./(2.*L)) +...
    2.*a.*L.*sin((6.*r1 - 3.*r2)./(2.*L)) + 2.*a.*L.*sin((3.*(r1 - 2.*r2))./(2.*L)) -...
    24.*a.^2.*sin((3.*(r1 - r2))./(2.*L)) + 6.*d.^2.*sin((3.*(r1 - r2))./(2.*L)) -...
    3.*r1.^2.*sin((3.*(r1 - r2))./(2.*L)) + 6.*r1.*r2.*sin((3.*(r1 - r2))./(2.*L)) -...
    3.*r2.^2.*sin((3.*(r1 - r2))./(2.*L)) + 6.*a.^2.*sin((3.*(r1 - r2))./L) +...
    14.*a.*L.*sin((3.*r2)./(2.*L)) - 9.*r1.^2.*sin((3.*(r1 + r2))./(2.*L)) +...
    18.*r1.*r2.*sin((3.*(r1 + r2))./(2.*L)) - 9.*r2.^2.*sin((3.*(r1 + r2))./(2.*L)))))./...
    (16.*L.*pi.*(d.^2 + a.^2.*(cos((3.*r1)./(2.*L)) - cos((3.*r2)./(2.*L))).^2 +...
    (r1 - r2 + a.*sin((3.*r1)./(2.*L)) - a.*sin((3.*r2)./(2.*L))).^2).^(7./2));

zddot = Amp*sin(Omega.*t);

rdot1 = r(:,2);
rdot2 = (-gamma1*r1 - mu1*r(:,2) + F1 - alpha1*zddot)/beta1;
rdot3 = r(:,4);
rdot4 = (-gamma2*r2 - mu2*r(:,4) + F2 - alpha2*zddot)/beta2;

rdot  = [rdot1, rdot2, rdot3, rdot4];